function preload(){game.load.tilemap("level","assets/escenarioNavidad2.json",null,Phaser.Tilemap.TILED_JSON),game.load.image("rain","assets/rain.png"),game.load.image("arbolNavidad2","assets/arbolNavidad2.png"),game.load.image("fondoEstrellas2","assets/fondoEstrellas2.jpg"),game.load.image("luzAmarilla","assets/luzAmarilla.png"),game.load.image("luzCeleste","assets/luzCeleste.png"),game.load.image("luzIntensa1","assets/luzIntensa1.png"),game.load.image("luzIntensa3","assets/luzIntensa3.png"),game.load.image("muniecoNieve","assets/muniecoNieve.png"),game.load.image("laTierra2","assets/laTierra2.png"),game.load.image("nube","assets/nube.png"),game.load.image("castillo","assets/castillo.png"),game.load.image("star","assets/estrellitaNavidad.png"),game.load.image("collitionTile","assets/collitionTile.png"),game.load.image("luzNoIntesa","assets/luzNoIntesa.png"),game.load.image("luzNoIntesa2","assets/luzNoIntesa2.png"),game.load.image("pesebre","assets/pesebre.png"),game.load.image("burrito","assets/burrito.png"),game.load.image("rudolph2","assets/rudolph2.png"),game.load.spritesheet("regalo","assets/regalo.png"),game.load.spritesheet("regalo2","assets/regalo2.png"),game.load.spritesheet("regalo4","assets/regalo4.png"),game.load.audio("rodolfo","assets/rodolfo.ogg"),game.load.audio("prender","assets/sonido1.ogg"),game.load.audio("burrito","assets/burrito.ogg"),game.load.audio("alMundoPaz","assets/alMundoPaz.ogg"),game.load.audio("frosty","assets/frosty.ogg"),game.load.audio("navidad","assets/navidadMusica.ogg")}function create(){game.physics.startSystem(Phaser.Physics.ARCADE),game.world.setBounds(0,0,2656,928),map=game.add.tilemap("level"),map.addTilesetImage("arbolNavidad2","arbolNavidad2"),map.addTilesetImage("fondoEstrellas2","fondoEstrellas2"),map.addTilesetImage("castillo","castillo"),map.addTilesetImage("nube","nube"),map.addTilesetImage("laTierra2","laTierra2"),map.addTilesetImage("luzAmarilla","luzAmarilla"),map.addTilesetImage("luzCeleste","luzCeleste"),map.addTilesetImage("luzIntensa1","luzIntensa1"),map.addTilesetImage("luzIntensa3","luzIntensa3"),map.addTilesetImage("collitionTile","collitionTile"),map.addTilesetImage("muniecoNieve","muniecoNieve"),map.addTilesetImage("luzNoIntesa","luzNoIntesa"),map.addTilesetImage("luzNoIntesa2","luzNoIntesa2"),map.addTilesetImage("pesebre","pesebre"),map.addTilesetImage("burrito","burrito"),map.addTilesetImage("rudolph2","rudolph2"),layer1=map.createLayer(0),layer2=map.createLayer(1),layer5=map.createLayer(4),layer6=map.createLayer(5),layer7=map.createLayer(6),layer8=map.createLayer(7),layer9=map.createLayer(8),layer10=map.createLayer(9),layer11=map.createLayer(10),layer12=map.createLayer(11),game.renderType===Phaser.WEBGL&&(max=200);var a=game.add.spriteBatch();stars=[];for(var b=0;b<max;b++){xx[b]=Math.floor(1200*Math.random())-400,yy[b]=Math.floor(600*Math.random())-300,zz[b]=Math.floor(170*Math.random())-100;var c=game.make.sprite(0,0,"regalo"),d=game.make.sprite(0,0,"regalo2"),e=game.make.sprite(0,0,"regalo4"),f=game.make.sprite(0,0,"luzAmarilla"),g=game.make.sprite(0,0,"luzCeleste");c.anchor.set(.5),d.anchor.set(.5),f.anchor.set(.5),e.anchor.set(.5),g.anchor.set(.5),a.addChild(c),a.addChild(d),a.addChild(e),a.addChild(f),a.addChild(g),stars.push(c),stars.push(d),stars.push(f),stars.push(e),stars.push(g)}layer3=map.createLayer(2),atari=game.add.sprite(2e3,850,"star"),atari.anchor.setTo(.5,.5),atari.scale.setTo(.9,.9),game.physics.arcade.gravity.y=200,game.physics.arcade.enable(game.world,!0),atari.body.allowGravity=0,atari.body.immovable=!0,atari.body.collideWorldBounds=!0,atari.setScaleMinMax(.1,2),game.camera.follow(atari,Phaser.Camera.FOLLOW_TOPDOWN),cursors=game.input.keyboard.createCursorKeys(),spacebar=game.input.keyboard.addKey(Phaser.KeyCode.SPACEBAR),letraE=game.input.keyboard.addKey(Phaser.KeyCode.E),letraR=game.input.keyboard.addKey(Phaser.KeyCode.R),layer4=map.createLayer(3),layer5.visible=!1,layer6.visible=!1,layer7.visible=!1,layer8.visible=!1,layer9.visible=!1,layer10.visible=!1,fx=game.add.audio("burrito"),fx.allowMultiple=!0,yeah=game.add.audio("alMundoPaz"),yeah.allowMultiple=!0,iuju=game.add.audio("prender"),iuju.allowMultiple=!0,rodolfo=game.add.audio("rodolfo"),rodolfo.allowMultiple=!0,frosty=game.add.audio("frosty"),frosty.allowMultiple=!0,navidad=game.add.audio("navidad"),navidad.allowMultiple=!0,emitter=game.add.emitter(game.world.centerX,0,200),emitter.width=game.world.width,emitter.makeParticles("rain"),emitter.minParticleScale=.1,emitter.maxParticleScale=.5,emitter.setYSpeed(300,500),emitter.setXSpeed(-5,5),emitter.minRotation=0,emitter.maxRotation=0,emitter.start(!1,1600,5,0)}function encenderLuzIntesa1(){letraE.downDuration(50)?0==layer5.visible&&(layer5.visible=!0,layer7.visible=!0,layer11.visible=!1,iuju.play()):letraR.downDuration(50)&&1==layer5.visible&&(layer5.visible=!1,layer7.visible=!1,layer11.visible=!0,iuju.play())}function encenderLuzIntesa2(){letraE.downDuration(50)?0==layer6.visible&&(layer6.visible=!0,layer8.visible=!0,layer12.visible=!1,iuju.play()):letraR.downDuration(50)&&1==layer6.visible&&(layer6.visible=!1,layer8.visible=!1,layer12.visible=!0,iuju.play())}function elBurrito(){letraE.downDuration(50)?0==burritoAndando&&(yeah.stop(),rodolfo.stop(),frosty.stop(),navidad.stop(),navidadAndando=!1,frostyAndando=!1,rodolfoAndando=!1,fx.play(),alMundoPazAndando=!1,burritoAndando=!0):letraR.downDuration(50)&&1==burritoAndando&&(fx.stop(),burritoAndando=!1)}function alMundoPaz(){letraE.downDuration(50)?0==alMundoPazAndando&&(fx.stop(),frosty.stop(),frostyAndando=!1,rodolfo.stop(),rodolfoAndando=!1,yeah.play(),navidad.stop(),navidadAndando=!1,alMundoPazAndando=!0,burritoAndando=!1):letraR.downDuration(50)&&1==alMundoPazAndando&&(yeah.stop(),alMundoPazAndando=!1)}function rodolfoMusica(){letraE.downDuration(50)?0==rodolfoAndando&&(fx.stop(),yeah.stop(),frosty.stop(),navidad.stop(),navidadAndando=!1,frostyAndando=!1,rodolfo.play(),rodolfoAndando=!0,burritoAndando=!1,alMundoPazAndando=!1):letraR.downDuration(50)&&1==rodolfoAndando&&(rodolfo.stop(),rodolfoAndando=!1)}function frostyMusica(){letraE.downDuration(50)?0==frostyAndando&&(fx.stop(),yeah.stop(),rodolfo.stop(),navidad.stop(),navidadAndando=!1,frosty.play(),frostyAndando=!0,rodolfoAndando=!1,burritoAndando=!1,alMundoPazAndando=!1):letraR.downDuration(50)&&1==frostyAndando&&(frosty.stop(),frostyAndando=!1)}function update(){if(atari.angle=0,atari.position.x>=595&&atari.position.x<=625&&atari.position.y>=140&&atari.position.y<=175&&encenderLuzIntesa1(),atari.position.x>=2260&&atari.position.x<=2280&&atari.position.y>=150&&atari.position.y<=170&&encenderLuzIntesa2(),1==layer5.visible&&1==layer6.visible?atari.position.x>=535&&atari.position.x<=655&&atari.position.y>=645&&atari.position.y<=770?elBurrito():atari.position.x>=85&&atari.position.x<=380&&atari.position.y>=515&&atari.position.y<=810?alMundoPaz():atari.position.x>=1189&&atari.position.x<=1274&&atari.position.y>=780&&atari.position.y<=885?rodolfoMusica():atari.position.x>=1571&&atari.position.x<=1696&&atari.position.y>=671&&atari.position.y<=846?frostyMusica():0==navidadAndando&&0==frostyAndando&&0==rodolfoAndando&&0==burritoAndando&&0==alMundoPazAndando&&(navidad.loopFull(.7),navidadAndando=!0):(fx.stop(),frosty.stop(),rodolfo.stop(),yeah.stop(),navidad.stop(),frostyAndando=!1,rodolfoAndando=!1,burritoAndando=!1,alMundoPazAndando=!1,navidadAndando=!1),atari.body.velocity.x=0,atari.body.velocity.y=0,cursors.up.isDown?atari.body.velocity.y-=300+acelerador:cursors.down.isDown&&(atari.body.velocity.y+=300+acelerador),cursors.left.isDown?(atari.body.velocity.x-=300+acelerador,atari.angle=-10):cursors.right.isDown&&(atari.body.velocity.x+=300+acelerador,atari.angle=10),spacebar.isDown?acelerador=250:acelerador=0,1==layer5.visible&&1==layer6.visible)for(var a=0;a<max;a++)stars[a].perspective=distance/(distance-zz[a]),stars[a].x=game.world.centerX+xx[a]*stars[a].perspective,stars[a].y=game.world.centerY-30+yy[a]*stars[a].perspective,zz[a]+=speed,zz[a]>290&&(zz[a]-=600),stars[a].alpha=Math.min(stars[a].perspective/2,1),stars[a].scale.set(stars[a].perspective/2),stars[a].rotation+=.1}var game=new Phaser.Game(1200,600,Phaser.AUTO,"gameDiv",{preload:preload,create:create,update:update}),emitter,atari,map,cursors,spacebar,letraE,letraR,rodolfo,iuju,yeah,frosty,distance=300,speed=3,stars,layer8,layer1,layer2,layer3,layer4,layer5,layer6,layer7,layer9,layer10,max=100,xx=[],yy=[],zz=[],burritoAndando=!1,alMundoPazAndando=!1,rodolfoAndando=!1,frostyAndando=!1,navidadAndando=!1;